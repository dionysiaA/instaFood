{"version":3,"sources":["../src/routes/socialMediaRoutes.js"],"names":["InstagramAPI","require","instagramAPI","router","get","req","res","next","user","findOneAccessToken","id","then","value","userSelfMedia","media","console","log","data","map","images","standard_resolution","url","catch","send","Promise","all","getMediasByTag","medias","mergedArrays","reduce","acc","tags"],"mappings":";;;;;;AAOA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAXA,MAAMA,eAAeC,QAAQ,eAAR,CAArB;AACA,MAAMC,eAAe,IAAIF,YAAJ,CAAiB,qDAAjB,CAArB;AACA;AACA;AACA;AACA;;AAQA,MAAMG,SAAS,qBAAf;;AAEAA,OAAOC,GAAP,CAAW,QAAX,EAAqB,UAASC,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AAC5C,MAAGF,IAAIG,IAAP,EAAa;;AAEV,mBAAKC,kBAAL,CAAwBJ,IAAIG,IAAJ,CAASE,EAAjC,EACEC,IADF,CACOH,QAAQ;AACZ,aAAO,IAAIR,YAAJ,CAAiBQ,KAAKI,KAAtB,CAAP;AACD,KAHF,EAIGD,IAJH,CAIQT,gBAAgB;AACpBA,mBAAaW,aAAb,GACGF,IADH,CACQG,SAAS;AACbC,gBAAQC,GAAR,CAAYF,KAAZ,EAAmB,4BAAnB;AACA,eAAOA,MAAMG,IAAN,CAAWC,GAAX,CAAgBJ,KAAD,IAAW;AAC/B,iBAAOA,MAAMK,MAAN,CAAaC,mBAAb,CAAiCC,GAAxC;AACD,SAFM,CAAP;AAGD,OANH;AAOD,KAZH,EAaEC,KAbF,CAaQf,IAbR;AAcF,GAhBD,MAiBK;AACHD,QAAIiB,IAAJ,CAAS,oBAAT;AACD;AACF,CArBD;;AAuBApB,OAAOC,GAAP,CAAW,iBAAX,EAA8B,UAASC,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AACrD,MAAGF,IAAIG,IAAP,EAAa;AACX,mBAAKC,kBAAL,CAAwBJ,IAAIG,IAAJ,CAASE,EAAjC,EACGC,IADH,CACQH,QAAQ;AACZ,aAAO,IAAIR,YAAJ,CAAiBQ,KAAKI,KAAtB,CAAP;AACD,KAHH,EAIGD,IAJH,CAIQT,gBAAgB;AACpBsB,cAAQC,GAAR,CAAY,CAACvB,aAAawB,cAAb,CAA4B,MAA5B,CAAD,EACVxB,aAAawB,cAAb,CAA4B,QAA5B,CADU,EAEVxB,aAAawB,cAAb,CAA4B,UAA5B,CAFU,EAGVxB,aAAawB,cAAb,CAA4B,SAA5B,CAHU,CAAZ,EAIGf,IAJH,CAIQgB,UAAU;AACd,cAAMC,eAAeD,OAAOE,MAAP,CAAc,CAACC,GAAD,EAAMhB,KAAN,KAAgB;AACjD,iBAAO,CAAC,GAAGA,MAAMG,IAAV,CAAP;AACD,SAFoB,EAElB,EAFkB,CAArB;AAGAF,gBAAQC,GAAR,CAAYY,YAAZ,EAA0B,+BAA1B;AACA,eAAOA,aAAaV,GAAb,CAAkBJ,KAAD,IAAW;AACjC,iBAAO;AACLO,iBAAKP,MAAMK,MAAN,CAAaC,mBAAb,CAAiCC,GADjC;AAELU,kBAAMjB,MAAMiB;AAFP,WAAP;AAID,SALM,CAAP;AAMD,OAfH;AAgBD,KArBH,EAsBGT,KAtBH,CAsBSf,IAtBT;AAuBD,GAxBD,MAyBK;AACHD,QAAIiB,IAAJ,CAAS,oBAAT;AACD;AACF,CA7BD;kBA8BepB,M","file":"socialMediaRoutes.js","sourcesContent":["const InstagramAPI = require('instagram-api');\nconst instagramAPI = new InstagramAPI('4243299161.9c74f6e.477008a1fab94fe0ab6b3577a13bed39');\n// https://www.instagram.com/oauth/authorize/?client_id=9c74f6e12b8d417eafa3b251ae54a196&redirect_uri=http://localhost:8080/login/instagram/return&response_type=token\n//motion_star= 4243299161.9c74f6e.477008a1fab94fe0ab6b3577a13bed39\n//dionyTech=5391727432.9c74f6e.b5fa16b737374992b13657eee765e3f1\n//deniseagath=\n\nimport URL from 'url';\nimport passport from 'passport';\nimport validator from 'validator';\nimport User from '../models/User';\nimport { Router } from 'express';\n\nconst router = new Router();\n\nrouter.get('/media', function(req, res, next) {\n  if(req.user) {\n\n     User.findOneAccessToken(req.user.id)\n      .then(user => {\n        return new InstagramAPI(user.value)\n      })\n       .then(instagramAPI => {\n         instagramAPI.userSelfMedia()\n           .then(media => {\n             console.log(media, 'this is one media in media')\n             return media.data.map((media) => {\n               return media.images.standard_resolution.url\n             })\n           })\n       })\n      .catch(next)\n  }\n  else {\n    res.send('404 user not found')\n  }\n})\n\nrouter.get('/media/foodTags', function(req, res, next) {\n  if(req.user) {\n    User.findOneAccessToken(req.user.id)\n      .then(user => {\n        return new InstagramAPI(user.value)\n      })\n      .then(instagramAPI => {\n        Promise.all([instagramAPI.getMediasByTag('food'),\n          instagramAPI.getMediasByTag('foodie'),\n          instagramAPI.getMediasByTag('foodporn'),\n          instagramAPI.getMediasByTag('ravioli')])\n          .then(medias => {\n            const mergedArrays = medias.reduce((acc, media) => {\n              return [...media.data]\n            }, [])\n            console.log(mergedArrays, 'this is one media in foodTags')\n            return mergedArrays.map((media) => {\n              return {\n                url: media.images.standard_resolution.url,\n                tags: media.tags\n              }\n            })\n          })\n      })\n      .catch(next)\n  }\n  else {\n    res.send('404 user not found')\n  }\n})\nexport default router;\n"]}