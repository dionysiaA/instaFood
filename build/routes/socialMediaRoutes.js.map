{"version":3,"sources":["../src/routes/socialMediaRoutes.js"],"names":["InstagramAPI","require","instagramAPI","router","get","req","res","next","user","console","log","userSelfMedia","then","media","data","map","images","standard_resolution","url","catch","send","findOne","id","getClaims","where","Promise","all","getMediasByTag","medias","mergedArrays","reduce","acc","tags"],"mappings":";;;;;;AAOA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAXA,MAAMA,eAAeC,QAAQ,eAAR,CAArB;AACA,MAAMC,eAAe,IAAIF,YAAJ,CAAiB,qDAAjB,CAArB;AACA;AACA;AACA;AACA;;AAQA,MAAMG,SAAS,qBAAf;;AAEAA,OAAOC,GAAP,CAAW,QAAX,EAAqB,UAASC,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AAC5C,MAAGF,IAAIG,IAAP,EAAa;AACXC,YAAQC,GAAR,CAAYL,IAAIG,IAAhB,EAAsB,6BAAtB;AACAN,iBAAaS,aAAb,GACGC,IADH,CACQC,SAAS;AACbJ,cAAQC,GAAR,CAAYG,KAAZ,EAAmB,4BAAnB;AACA,aAAOA,MAAMC,IAAN,CAAWC,GAAX,CAAgBF,KAAD,IAAW;AAC/B,eAAOA,MAAMG,MAAN,CAAaC,mBAAb,CAAiCC,GAAxC;AACD,OAFM,CAAP;AAGD,KANH,EAOGC,KAPH,CAOSZ,IAPT;AAQD,GAVD,MAWK;AACHD,QAAIc,IAAJ,CAAS,oBAAT;AACD;AACF,CAfD;;AAiBAjB,OAAOC,GAAP,CAAW,iBAAX,EAA8B,UAASC,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AACrD,MAAGF,IAAIG,IAAP,EAAa;AACX,UAAMA,OAAO,eAAKa,OAAL,CAAa,IAAb,EAAmBhB,IAAIG,IAAJ,CAASc,EAA5B,EACVV,IADU,CACLJ,QAAQC,QAAQC,GAAR,CAAYF,KAAKe,SAAL,CAAe,EAAEC,OAAOnB,IAAIG,IAAJ,CAASc,EAAlB,EAAf,CAAZ,EAAmD,kBAAnD,CADH,CAAb;AAEAb,YAAQC,GAAR,CAAYL,IAAIG,IAAhB,EAAsB,+BAAtB;;AAEAiB,YAAQC,GAAR,CAAY,CAACxB,aAAayB,cAAb,CAA4B,MAA5B,CAAD,EACVzB,aAAayB,cAAb,CAA4B,QAA5B,CADU,EAEVzB,aAAayB,cAAb,CAA4B,UAA5B,CAFU,EAGVzB,aAAayB,cAAb,CAA4B,SAA5B,CAHU,CAAZ,EAIGf,IAJH,CAIQgB,UAAU;AACd,YAAMC,eAAeA,eAAeD,OAAOE,MAAP,CAAc,CAACC,GAAD,EAAKlB,KAAL,KAAe;AAC/D,eAAO,CAAC,GAAGA,MAAMC,IAAV,CAAP;AACD,OAFmC,EAEjC,EAFiC,CAApC;AAGAL,cAAQC,GAAR,CAAYmB,YAAZ,EAA0B,+BAA1B;AACA,aAAOA,aAAad,GAAb,CAAkBF,KAAD,IAAW;AACjC,eAAO;AACLK,eAAKL,MAAMG,MAAN,CAAaC,mBAAb,CAAiCC,GADjC;AAELc,gBAAMnB,MAAMmB;AAFP,SAAP;AAID,OALM,CAAP;AAMD,KAfH,EAgBGb,KAhBH,CAgBSZ,IAhBT;AAiBD,GAtBD,MAuBK;AACHD,QAAIc,IAAJ,CAAS,oBAAT;AACD;AACF,CA3BD;kBA4BejB,M","file":"socialMediaRoutes.js","sourcesContent":["const InstagramAPI = require('instagram-api');\nconst instagramAPI = new InstagramAPI('4243299161.9c74f6e.477008a1fab94fe0ab6b3577a13bed39');\n// https://www.instagram.com/oauth/authorize/?client_id=9c74f6e12b8d417eafa3b251ae54a196&redirect_uri=http://localhost:8080/login/instagram/return&response_type=token\n//motion_star= 4243299161.9c74f6e.477008a1fab94fe0ab6b3577a13bed39\n//dionyTech=5391727432.9c74f6e.b5fa16b737374992b13657eee765e3f1\n//deniseagath=\n\nimport URL from 'url';\nimport passport from 'passport';\nimport validator from 'validator';\nimport User from '../models/User';\nimport { Router } from 'express';\n\nconst router = new Router();\n\nrouter.get('/media', function(req, res, next) {\n  if(req.user) {\n    console.log(req.user, 'is there any user in media?')\n    instagramAPI.userSelfMedia()\n      .then(media => {\n        console.log(media, 'this is one media in media')\n        return media.data.map((media) => {\n          return media.images.standard_resolution.url\n        })\n      })\n      .catch(next)\n  }\n  else {\n    res.send('404 user not found')\n  }\n})\n\nrouter.get('/media/foodTags', function(req, res, next) {\n  if(req.user) {\n    const user = User.findOne('id', req.user.id)\n      .then(user => console.log(user.getClaims({ where: req.user.id}), 'here is the user'));\n    console.log(req.user, 'is there any user in foodTags')\n\n    Promise.all([instagramAPI.getMediasByTag('food'),\n      instagramAPI.getMediasByTag('foodie'),\n      instagramAPI.getMediasByTag('foodporn'),\n      instagramAPI.getMediasByTag('ravioli')])\n      .then(medias => {\n        const mergedArrays = mergedArrays = medias.reduce((acc,media) => {\n          return [...media.data]\n        }, [])\n        console.log(mergedArrays, 'this is one media in foodTags')\n        return mergedArrays.map((media) => {\n          return {\n            url: media.images.standard_resolution.url,\n            tags: media.tags\n          }\n        })\n      })\n      .catch(next)\n  }\n  else {\n    res.send('404 user not found')\n  }\n})\nexport default router;\n"]}